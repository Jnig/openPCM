<?php

namespace Jan\ZevirtBundle\Entity;

use Doctrine\ORM\Mapping as ORM;


/**
 *
 * @ORM\Table()
 * @ORM\Entity
 */
class Changed
{
    /**
     * @var integer $id
     *
     * @ORM\Column(name="id", type="integer")
     * @ORM\Id
     * @ORM\GeneratedValue(strategy="AUTO")
     */
    protected $id;
 
    /**
     *
     * @ORM\Column(type="string", length=255, nullable=true)
     */
    private $action;
    
    
    /**
     *
     * @ORM\Column(type="string", length=255, nullable=true)
     */
    private $entity;
    

    /**
     * @var integer $id
     *
     * @ORM\Column(type="integer", nullable=true)
     */
    protected $entityId;
    
    
    public function toArray() {
        $ar = array(
                'state' => $this->getJob()->getState(),
                'command' => $this->getJob()->getCommand().' '.implode(' ', $this->getJob()->getArgs()),
                'createdAt' => $this->getJob()->getCreatedAt()->format('Y-m-d H:i:s'),
                'name' => $this->getName()
        );
        
        if (count($this->getUser())) {
            $ar['owner'] = $this->getUser()->getFirstName().' '.$this->getUser()->getSecondName();
        }
        
        return $ar;
    }
    
}